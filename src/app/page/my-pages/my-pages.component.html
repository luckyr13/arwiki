<div class="mt-main"></div>
<mat-progress-bar 
	mode="indeterminate"
	*ngIf="loading"
	class="fadeIn"></mat-progress-bar>
<mat-toolbar class="fadeIn" color="default">
  <mat-icon 
  	aria-hidden="false"
  	aria-label="My pages">folder_open</mat-icon>
	<span>&nbsp;My pages</span>
	<div class="menu-spacer"></div>
	<div class="text-right page-title-buttons">	
    <button 
    	type="button"
	  	mat-button
	  	color="default"
	  	(click)="goBack()">
	    <mat-icon>navigate_before</mat-icon>
	    {{ 'GENERAL.BUTTONS.GO_BACK' | translate }}
	  </button>
	</div>
</mat-toolbar>

<div class="container fadeIn" *ngIf="!loading" >
	<h1 class="page-title col-12">
		My arwiki pages
	</h1>
	<div class="row" *ngIf="pages && pages.length === 0">
		<div class="col-12 text-center no-results">
			You don't have any arwiki page yet ðŸ˜¸
		</div>
		<div class="col-12 text-center">
			<a mat-flat-button 
        routerLink="/{{ routeLang }}/create-page" color="primary">
				Create new arwiki page
			</a>
		</div>
	</div>
	<div class="row">
		<div class="col-12 col-md-6 card-page-container fadeIn" *ngFor="let page of pages">
			<mat-card class="card-page">
		    <button 
		    	routerLink="../{{page.slug}}"
		    	mat-icon-button 
		    	class="card-header-icon yellow" 
		    	*ngIf="page.sponsor"
		    	matTooltip="Page approved!"
		    	aria-label="Page approved!">
	        <mat-icon>star</mat-icon>
	      </button>
		    <h2 class="link ellipsis card-header-title" routerLink="../preview/{{page.id}}">
		    	{{  page.title }}
		    </h2>
			  <mat-card-content class="card-body">
					<div *ngIf="page.img" class="text-center">
						<img class="card-page-img" src="{{ page.img }}">
					</div>
					<div>
						Slug: {{ page.slug }}
					</div>
					<div>
						Category: {{ page.category }}
					</div>
					<div>
						Language: {{ page.language }}
					</div>
					<div>
						Value: {{ page.value }} $WIKI
					</div>
				  <hr class="mbt20">
					<div class="mini-text"> 
						<app-arweave-address 
							[address]="page.id"
							[isAddress]="false">{{ 'PAGE.LABEL_ID' | translate }}: </app-arweave-address>
					</div>
					<div class="mini-text" *ngIf="page.sponsor">
						<app-arweave-address 
							[address]="page.sponsor"
							[isAddress]="false">Sponsor: </app-arweave-address>
					</div>
					<div class="mini-text" *ngIf="page.block && page.block.height">
						<strong>{{ 'PAGE.LABEL_BLOCK_HEIGHT' | translate }}:</strong>
						{{ page.block.height }} 
					</div>
					<div class="mini-text" *ngIf="page.block && page.block.timestamp">
						<strong>{{ 'PAGE.LABEL_BLOCK_TIMESTAMP' | translate }}:</strong>
						{{ timestampToDate(page.block.timestamp) | date:'short' }} 
					</div>
					<div *ngIf="page.paidAt" class="mini-text green">
						<strong>Paid at:</strong>
						{{ page.paidAt }}
					</div>
					<div *ngIf="page.pageRewardAt" class="mini-text">
						<strong>Page reward at: </strong>
						<span>{{ page.pageRewardAt }} block</span>
						<strong class="green" *ngIf="currentBlockHeight >= page.pageRewardAt && !page.paidAt">
							- Reward unlocked!
						</strong>
						<span *ngIf="currentBlockHeight < page.pageRewardAt">
							- Reward unlocked in {{ page.pageRewardAt - currentBlockHeight }} blocks!
						</span>
					</div>

				</mat-card-content>
				<mat-card-actions class="text-right card-footer">
					<a 
						mat-flat-button color="primary" 
			    	*ngIf="page.sponsor && page.pageRewardAt && currentBlockHeight >= page.pageRewardAt && !page.paidAt"
			    	(click)="unlockReward(page.language, page.slug)">
						<mat-icon class="yellow" >star</mat-icon> Claim reward
					</a>
					&nbsp;
					<a 
			    	*ngIf="!page.sponsor" 
			    	mat-flat-button color="primary" routerLink="../preview/{{page.id}}">
						<mat-icon>visibility</mat-icon> Preview
					</a>
					<a
			    	*ngIf="page.sponsor"
			    	 mat-flat-button color="primary" routerLink="../{{page.slug}}">
						<mat-icon>visibility</mat-icon> Read article
					</a>
				</mat-card-actions>
			</mat-card>
		</div>
	</div>

</div>